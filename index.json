[{"categories":null,"content":"hook ç»§æ‰¿ä¸åŸå‹é“¾ - JavaScript | MDN (mozilla.org) this æŒ‡å‘é—®é¢˜ï¼šJSå‡½æ•°hook_æ„§æ€å°å„¿çš„åšå®¢-CSDNåšå®¢_hook jså‡½æ•° å‡½æ•° hook let btoa_bk = btoa; btoa = function(val){ console.log(val) debugger; return btoa_bk } (function () { function hook(object, attr) { var func = object[attr]; object[attr] = function () { console.log(\"hooked\", object, attr); var ret = func.apply(object, arguments); debugger; return ret; }; } hook(window, \"btoa\"); })(); å±æ€§ hook Object.definePropertyï¼šObject.defineProperty Object.defineProperty() æ–¹æ³•ä¼šç›´æ¥åœ¨ä¸€ä¸ªå¯¹è±¡ä¸Šå®šä¹‰ä¸€ä¸ªæ–°å±æ€§ï¼Œæˆ–è€…ä¿®æ”¹ä¸€ä¸ªå¯¹è±¡çš„ç°æœ‰å±æ€§ï¼Œå¹¶è¿”å›æ­¤å¯¹è±¡ã€‚ // ä¾‹å­ Object.defineProperty(docment, 'cookie', { set: function(val){ debugger; return val } }) åˆ©ç”¨æ²¹çŒ´è„šæœ¬æ–¹å¼æ³¨å…¥ TODO åˆ©ç”¨æ§åˆ¶å°æ–¹å¼æ³¨å…¥ TODO ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/hook/:0:0","tags":null,"title":"Hook","uri":"/koko.github.io/posts/javascript_reverse/hook/"},{"categories":null,"content":"JavaScript é€†å‘ ğŸ˜…ğŸ˜¥ğŸ‘¶ğŸ˜ƒğŸ§¥ğŸ¶ğŸâš½ï¸âœ‚ğŸˆ²ğŸš—âŒšï¸â¤ï¸ğŸâ–¶ ä¹‹å­¦ä¹ æ€»ç»“ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:0:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"å¸¸è§åŠ å¯†ã€è§£å¯†ã€è°ƒè¯•æ‰‹æ®µ API å‚æ•°åŠ å¯† å‘èµ·è¯·æ±‚æ—¶ä¼šæ ¡éªŒé™„å¸¦çš„å‚æ•°ï¼Œå¦‚ tokenã€signç­‰ Cookie å‚æ•°è§£å¯† cookie ç”± JavaScript åŠ¨æ€ç”Ÿæˆ åŠ å¯† ob æ··æ·† webpack worker asyncï¼šå¼‚æ­¥è°ƒè¯• jsl åŠ é€Ÿä¹ sojsonv6 TLS æŒ‡çº¹ protobuf jsvmp wasm ç‘æ•° æ–‡å­—éªŒè¯ç  é¡¶è±¡ æéªŒ æ•°ç¾ ç½‘æ˜“æ˜“ç›¾ 5ç§’ç›¾ akamai è°·æ­ŒéªŒè¯ç  å­—ä½“åçˆ¬ è§£å¯† hook AST ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:1:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"ob æ··æ·†ç¯‡ å®˜ç½‘ï¼šhttps://obfuscator.io/ ob æ··æ·†æ˜¯å¸¸è§çš„ä¸€ç§æ··æ·†æ–¹å¼ï¼Œå…³äºä»‹ç»å¯ä»¥å»ç™¾åº¦æˆ–è€…å®˜ç½‘äº†è§£ æ··æ·†å‰ function hi() { console.log(\"Hello World!\"); } hi(); æ··æ·†åéƒ¨åˆ†æˆªå›¾ å¦‚æœæ˜¯åˆ©ç”¨å¼€æºåº“è¿›è¡Œæ··æ·†çš„ JS å¯ä»¥ç”¨ä¸‹é¢è§£æ··æ·† Tsaiboss/decodeObfuscator: å…å®‰è£…ä¸€é”®è¿˜åŸObfuscatoræ··æ·†è¿‡çš„ä»£ç  (github.com) ä¹Ÿå¯ä»¥åˆ©è‡ªè¡Œç¼–å†™ AST ä»£ç ï¼Œè¿™é‡Œæš‚æ—¶ä¸å±•å¼€è®¨è®º obæ··æ·†æ¡ˆä¾‹ç½‘å€ï¼š51jobã€å‰ç¨‹æ— å¿§ æ­¤ç½‘å€çš„ cookie è®¾ç½®äº†æœ‰æ•ˆæ—¶é—´ï¼Œæ‰“ä¸Š script æ–­ç‚¹åå¾ˆå®¹æ˜“æ‰¾åˆ°ç”Ÿæˆ cookie çš„å‡½æ•°å…¥å£ å¯ä»¥å‘ç° name æ˜¯ä¸€ä¸ªå›ºå®šçš„å­—ç¬¦ä¸²æˆ‘ä»¬å¯ä»¥å®šæ­»ï¼Œè€Œ x å‚æ•°é€šè¿‡å †æ ˆä¸­å¾—çŸ¥ x = arg2 arg2 ç”± _0x23a392 å¾—æ¥ï¼Œarg1 å‚æ•°æ˜¯ç”±æœåŠ¡å™¨å‘çš„å›ºå®šå­—ç¬¦ä¸² ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬çœ‹ä»£ç æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ decodeObfuscator è§£æ··æ·†ï¼Œè§£æ··æ·†å‰å æˆ‘ä»¬å¯ä»¥æ›´æ¸…æ¥šçš„å»åˆ†æå‡½æ•°ä¹‹é—´çš„å…³ç³» åˆ†æç»“æŸåå°±æ˜¯æ‰£ä»£ç çš„æµç¨‹äº†ï¼Œè¿™é‡Œå°±ä¸å¤šèµ˜è¿°äº†ï¼Œç›´æ¥è´´ä¸Šè¿è¡Œç»“æœ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:2:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"webpack ç¯‡ webpack æ˜¯å‰ç«¯æ‰“åŒ…å¸¸ç”¨æ‰‹æ®µï¼Œå¹¶ä¸æ˜¯åŠ å¯†æ‰‹æ®µï¼Œåªæ˜¯ç»è¿‡ webpack æ‰“åŒ…çš„ js å¯¹é€†å‘æœ‰ä¸€å®šçš„å½±å“ ä¸­æ–‡å®˜ç½‘ï¼šæ¦‚å¿µ | webpack ä¸­æ–‡ç½‘ (webpackjs.com) webpack æ ‡è¯† !(function(e) { //åˆ†å‘å™¨ function u(n) { ..... return e[n].call(t.exports, t, t.exports, u), t.l = !0, t.exports }({ // æ¨¡å— 'test': function(){}, })); ç»è¿‡ webpack æ‰“åŒ…çš„ä»£ç ä¸€èˆ¬é•¿è¿™æ ·ï¼Œç”±åˆ†å‘å™¨å’Œå¾…åŠ è½½çš„æ¨¡å—ç»„æˆ æ¡ˆä¾‹ç½‘å€ï¼šScrape | Movie é€šè¿‡æŠ“åŒ…å‘ç°ï¼Œæ•°æ®æ¥å£ç”± token å€¼æ˜¯ç»è¿‡åŠ å¯†çš„ ç»è¿‡æŸ¥æ‰¾å †æ ˆå¯ä»¥å‘ç°åŠ å¯†å‡½æ•°å…¥å£ï¼Œæˆ‘ä»¬åœ¨æ­¤å¤„ä¸‹æ–­ç‚¹åˆ·æ–°é¡µé¢ï¼Œæ–­ä½åå•æ­¥è°ƒè¯•è·Ÿè¿›å» è·Ÿè¿›å»åæˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°è¯¥åˆ†å‘å™¨ï¼Œç„¶åå°†è¯¥åˆ†å‘å™¨å¯¼å‡ºæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨é‡Œé¢çš„æ¨¡å— æ‰£ä¸‹æ¥ï¼Œå°†å…¶ä»–æ— ç”¨çš„å‡½æ•°æ³¨é‡Šæ‰ï¼Œå®šä¹‰ä¸€ä¸ª windowï¼ˆå½“ç„¶ä»€ä¹ˆå˜é‡éƒ½è¡Œåªæ˜¯æˆ‘ä¹ æƒ¯äº†ï¼‰ var window = global; window._0x3ff111_ = _0x3ff111; //å°†åˆ†å‘å™¨å¯¼å‡º æ‰£å®Œåå¯ä»¥æµ‹è¯•ä¸€ä¸‹è¯¥åˆ†å‘å™¨æœ‰æ²¡æœ‰æ•ˆæœ æ¥ä¸‹æ¥å°±æ˜¯æ‰£åŠ å¯†æ‰€éœ€çš„æ¨¡å—äº† æ¯”å¦‚åœ¨æ§åˆ¶å°è¾“å‡º _0x2fa7bd[â€˜aâ€™] å‘ç°æ˜¯è¿™ä¸ªå‡½æ•°ï¼Œå®ƒæ‰€åœ¨çš„æ¨¡å—æ˜¯ â€˜7d92â€™ å°†ä»–æ•´ä¸ªæ‰£ä¸‹æ¥ï¼Œç¼ºä»€ä¹ˆæ¨¡å—å°±æ‰£ä»€ä¹ˆ ä¹Ÿå¯ä»¥ç›´æ¥å…¨éƒ¨å¤åˆ¶ä¸‹æ¥ï¼Œå»ºè®®ç”¨åˆ°ä»€ä¹ˆæ¨¡å—å°±æ‰£ä»€ä¹ˆæ¨¡å—ã€‚æˆ‘å·ä¸ªæ‡’ è°ƒç”¨æ¨¡å—è¿˜åŸåŠ å¯†é€»è¾‘ _0x2fa7bd æ˜¯ç”± â€œ7d92â€ æ¨¡å—åŠ è½½æ¥çš„ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:3:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"worker å¤šçº¿ç¨‹è°ƒè¯•ç¯‡ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:4:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"JSL åŠ é€Ÿä¹ç¯‡ æ¡ˆä¾‹ç½‘å€ï¼šå›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´å…±äº«å¹³å° è€è§„çŸ©å…ˆæŠ“åŒ…ï¼Œçœ‹ä¸€ä¸‹å®ƒæ˜¯æ€ä¹ˆä¸€ä¸ªæ“ä½œ å¯ä»¥çœ‹åˆ°ä»–æ˜¯å‘é€äº†ä¸‰æ¬¡è¯·æ±‚æ‰è¿”å›æ­£å¸¸çš„é¡µé¢ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚ Set-Cookie: __jsluid_s ï¼Œç»è¿‡ç¬¬ä¸€æ¬¡è¯·æ±‚åï¼Œç¬¬äºŒæ¬¡è¯·æ±‚å¸¦ç€ç¬¬ä¸€æ¬¡è¯·æ±‚çš„ set-cookie å’ŒåŠ å¯†å‡ºæ¥çš„ __jsl_clearance_s å‘é€è¯·æ±‚ï¼Œæœ€åä¸€æ¬¡è¯·æ±‚å¸¦ç€å†ä¸€æ¬¡åŠ å¯†è¿‡åçš„ __jsl_clearance_s è¿”å›è¦é‡‡é›†çš„æ•°æ® okï¼Œæˆ‘ä»¬æ‰“ä¸Š script æ–­ç‚¹ç„¶ååˆ·æ–°é¡µé¢ å¯ä»¥çœ‹è§ç¬¬ä¸€æ¬¡è¯·æ±‚ set-cookie åä¼šè¿”å›è¿™ä¸€ä¸² js ä»£ç ï¼Œå‘ç°è¿™å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ __jsl_clearance_s æˆ‘ä»¬ç»§ç»­æ­¥è¿›ï¼Œå‘ç°ç¬¬äºŒæ¬¡ __jsl_clearance_s çš„åŠ å¯†é€»è¾‘ï¼Œè¿™æ˜¯ä¸€ä¸ªç»è¿‡ ob æ··æ·†çš„åŠ å¯†ä»£ç ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡hook æˆ–è€…è§£æ··æ·†æ¥æ‰¾åˆ°å…¥å£å‡½æ•°ï¼Œç”±äºè¿™ä¸ªæ··æ·†åº¦æ¯”è¾ƒä½ç›´æ¥å°±èƒ½çœ‹å‡ºæ¥set cookie çš„ä½ç½® å¤šè°ƒè¯•å‡ æ¬¡å°±ä¼šå‘ç°å®ƒæ¯æ¬¡åŠ å¯† __jsl_clearance_s çš„åŠ å¯†ç®—æ³•ä¸åŒï¼Œåˆ†åˆ«æ˜¯ sha1 sha256 md5ï¼Œéœ€è¦æŠŠè¿™ä¸‰ä¸ªæ–‡ä»¶æŠ“å‡ºæ¥ï¼Œç„¶åå°±å¯ä»¥è¿›è¡Œæ‰£ä»£ç äº† ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:5:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"sojson ç¯‡ sojsonv6 åŠ å¯†ç½‘å€ï¼šhttps://www.jsjiami.com/ sojsonv6ï¼šsojsonv6è°ƒè¯•æ¡ˆä¾‹ ä¸­å›½äººæ°‘é“¶è¡Œ é€šè¿‡ç¬¬ä¸€æ¬¡è¯·æ±‚ set_cookie äº†ä¸€ä¸ª wzws_cidï¼Œè¿”å›ä¸€ä¸²ç»è¿‡ sojsonv6 åŠ å¯†çš„ js ç„¶åç»è¿‡åŠ å¯†åå¸¦ä¸Š wzwschallenge å‚æ•°å’Œ wzws_cid è¿™ä¸ªcookie åœ¨è¯·æ±‚ä¸€æ¬¡ï¼Œç„¶ååˆ set_cookie äº† wzws_cid æŠŠ cookie æ¸…ç©ºæ‰“ä¸Š script æ–­ç‚¹ï¼Œå¯ä»¥å‘ç°æœ‰è¿™ä¸ªæ˜æ˜¾çš„ç‰¹å¾ï¼Œè¿™ä¸ªæ–‡ä»¶å°±æ˜¯åŠ å¯† wzwschallenge çš„æ–‡ä»¶ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:6:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"async å¼‚æ­¥ç¯‡ å¼‚æ­¥è°ƒè¯•ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰ js å¼‚æ­¥è°ƒè¯•æŠ€å·§çš„æ–‡ç« åˆ†äº«ä¸€ä¸‹â€¦ (å¾…è¡¥å……) asyncï¼šå¼‚æ­¥è°ƒè¯•æ¡ˆä¾‹ aHR0cHM6Ly9tdXNpYy4xNjMuY29tLw== ç™»å½•ï¼ˆæ‰‹æœºå·-å¯†ç ï¼‰ï¼šåŠ å¯†å‚æ•° encSecKey parmas åˆ†ææ€è·¯ï¼šè¾“å…¥æ‰‹æœºå·ã€å¯†ç ã€ç‚¹å‡»ç™»å½• å¯ä»¥çœ‹è§è¯¥ post è¯·æ±‚ä¸‹é¢æœ‰ä¸¤ä¸ªåŠ å¯†å‚æ•° params å’Œ encSecKey æŸ¥çœ‹å †æ ˆæ‰“ä¸Šæ–­ç‚¹è¿›å…¥è°ƒè¯• æ‰“ä¸Šæ–­ç‚¹ä¹‹åæˆ‘ä»¬å¯ä»¥çœ‹è§å‚æ•° d é€šè¿‡è§‚å¯Ÿå¯ä»¥å‘ç° d è¿™ä¸ªå‚æ•°æ˜¯ b è¿™ä¸ªåŒ…çš„åŠ å¯†å‚æ•° d ç‚¹å‡»è¯¥æŒ‰é’®è·³è¿‡è¯¥æ–­ç‚¹æ—¶å‡ºç° params ç„¶åæˆ‘ä»¬æŸ¥çœ‹å †æ ˆï¼Œå‘ç°åœ¨è¿›å…¥è¿™ä¸ª g.asrsea è¿™ä¸ªå‡½æ•°æ—¶ params å‚æ•°ç”Ÿæˆ ä¸” g.asrsea è¿™ä¸ªå‡½æ•°ä¼ å…¥ f è¿™ä¸ªå€¼ï¼Œf é‡Œé¢åŒ…å«äº† æ‰‹æœºå·ã€å¯†ç ã€å’Œä¸€ä¸ª checktoken è¿™å‡ ä¸ªå…³é”®ä¿¡æ¯ å•æ­¥è°ƒè¯•è·Ÿè¿›å»ï¼Œå‘ç°åŠ å¯†å‡½æ•°ï¼Œæ­¤æ—¶ password å’Œ checktoken æ˜¯æœªçŸ¥çš„ é‡æ–°ç‚¹å‡»ç™»å½•ï¼Œé‡æ–°æ‰“ä¸Šæ–­ç‚¹ï¼Œåˆšåˆšæˆ‘ä»¬æ˜¯åœ¨ f è¿™é‡Œæˆ‘ä»¬ç»§ç»­å¾€ä¸‹çœ‹ï¼Œæ‰¾åˆ° checktoken å’Œ password çš„ç”Ÿæˆæ–¹å¼ å½“æˆ‘ä»¬æ‰¾åˆ° m.ia æ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ° checktoken æ˜¯ dc è¿™ä¸ªå‡½æ•°é€šè¿‡ r å’Œ x å‚æ•°åŠ å¯†å¾—æ¥ è€Œ r å‚æ•° ç”± bc è¿™ä¸ªå‡½æ•°å¾—æ¥ï¼Œè‡³æ­¤å°±å·® password åŠ å¯†äº† å’Œä¸Šé¢ä¸€æ ·ç»§ç»­æ‰¾å †æ ˆå°±å¯ä»¥å‘ç° password æ˜¯ç”± MD5 åŠ å¯†å¾—æ¥ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:7:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"},{"categories":null,"content":"TLS æŒ‡çº¹ TLS åŠå…¶å‰èº« SSL ç”¨äºä¸ºå¸¸è§åº”ç”¨ç¨‹åºå’Œæ¶æ„è½¯ä»¶åŠ å¯†é€šä¿¡ï¼Œä»¥ç¡®ä¿æ•°æ®å®‰å…¨ï¼Œå› æ­¤å¯ä»¥éšè—åœ¨å™ªéŸ³ä¸­ã€‚è¦å¯åŠ¨ TLS ä¼šè¯ï¼Œå®¢æˆ·ç«¯å°†åœ¨ TCP 3 æ¬¡æ¡æ‰‹ä¹‹åå‘é€ TLS å®¢æˆ·ç«¯ Hello æ•°æ®åŒ…ã€‚æ­¤æ•°æ®åŒ…åŠå…¶ç”Ÿæˆæ–¹å¼å–å†³äºæ„å»ºå®¢æˆ· ç«¯åº”ç”¨ç¨‹åºæ—¶ä½¿ç”¨çš„åŒ…å’Œæ–¹æ³•ã€‚æœåŠ¡å™¨å¦‚æœæ¥å— TLS è¿æ¥ï¼Œå°†ä½¿ç”¨åŸºäºæœåŠ¡å™¨ç«¯åº“å’Œé…ç½®ä»¥åŠ Client Hello ä¸­çš„è¯¦ ç»†ä¿¡æ¯åˆ¶å®šçš„ TLS Server Hello æ•°æ®åŒ…è¿›è¡Œå“åº”ã€‚ç”±äº TLS åå•†ä»¥æ˜æ–‡å½¢å¼ä¼ è¾“ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ TLS Client Hello æ•°æ®åŒ…ä¸­çš„è¯¦ç»†ä¿¡æ¯æ¥æŒ‡çº¹å’Œè¯†åˆ«å®¢æˆ·ç«¯åº”ç”¨ç¨‹åº ja3ï¼šJA3 is a standard for creating SSL client fingerprints in an easy to produce and shareable way TLS Fingerprinting with JA3 and JA3S | by John Althouse | Salesforce Engineering æ¨èæ–‡ç« ï¼šæ·±åº¦å‰–æja3æŒ‡çº¹åŠçªç ´ å¤§ä½¬æ–‡ç« é‡Œè¯´çš„å¾ˆè¯¦ç»† ja3æŒ‡çº¹è¡¥å……è¯´æ˜ ","date":"2022-05-16","objectID":"/koko.github.io/posts/javascript_reverse/readme/:8:0","tags":null,"title":"JavaScript é€†å‘","uri":"/koko.github.io/posts/javascript_reverse/readme/"}]